---
import type { ContentNode } from "../../types/content";
import Card from "../ui/Card.astro";
import Tag from "../ui/Tag.astro";

interface Props {
  items: ContentNode[];
}

const { items } = Astro.props as Props;

const getVariant = (item: ContentNode) =>
  item.type === "PERSONA"
    ? "person"
    : item.type === "PODCAST"
      ? "podcast"
      : item.data.isLive
        ? "live"
        : "event";
---

<section class="section-grid grid grid-cols-4 gap-6 auto-rows-[200px]">
  {
    items.map((item) => {
      const image = item.data.images?.[0];

      return (
        <Card size={item.style?.size ?? "medium"}>
          <div class="group relative h-full overflow-hidden">
            {/* IMAGEN */}
            {image && (
              <img
                src={image}
                alt={item.data.title}
                class="absolute inset-0 w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
              />
            )}

            {/* OVERLAY */}
            <div class="absolute inset-0 bg-black/40" />

            {/* CONTENIDO */}
            <div class="relative h-full p-5 flex flex-col justify-end text-white">
              <Tag
                label={item.data.label ?? item.type}
                variant={getVariant(item)}
                floating
              />

              <h3 class="font-heading text-xl leading-tight mt-2">
                {item.data.title}
              </h3>

              {item.data.date && (
                <p class="text-sm opacity-70 mt-1">{item.data.date}</p>
              )}
            </div>
          </div>
        </Card>
      );
    })
  }
</section>
