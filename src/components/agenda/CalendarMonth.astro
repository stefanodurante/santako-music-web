---
import { content } from "../../data/mock/content";

const events = content.filter((i) => i.type === "EVENTO");
const month = "2025-04";

const daysInMonth = new Date(2025, 4, 0).getDate();

const eventsByDay = events
  .filter((e) => e.data.date?.startsWith(month))
  .reduce((acc, e) => {
    const day = e.data.date!.split("-")[2];
    acc[day] = acc[day] || [];
    acc[day].push(e);
    return acc;
  }, {} as Record<string, typeof events>);
---
<section class="px-6 md:px-12 xl:px-24 container-wide">

  <div class="grid grid-cols-7 gap-px bg-black/10">

    {Array.from({ length: daysInMonth }, (_, i) => {
      const day = String(i + 1).padStart(2, "0");
      const dayEvents = eventsByDay[day] || [];
      const event = dayEvents[0];

      return (
        <div class="bg-[--color-base] min-h-[140px] p-3 relative">

          <!-- DÃA -->
          <span class="text-xs opacity-40 absolute top-2 right-2">
            {day}
          </span>

          <!-- SIN EVENTO -->
          {!event && (
            <div class="h-full flex items-center justify-center opacity-10 text-xs">
              â€”
            </div>
          )}

          <!-- CON EVENTO -->
          {event && (
            <a
              href={`/evento/${event.data.slug}`}
              class="group block h-full"
            >
              {event.data.images?.[0] && (
                <img
                  src={event.data.images[0]}
                  alt={event.data.title}
                  class="absolute inset-0 w-full h-full object-cover opacity-20 group-hover:opacity-30 transition"
                />
              )}

              <div class="relative z-10">
                <span class="block text-[10px] uppercase tracking-widest text-[--color-accent-event] mb-1">
                  Evento
                </span>

                <h3 class="font-heading text-sm leading-tight">
                  {event.data.title}
                </h3>
              </div>
            </a>
          )}

        </div>
      );
    })}

  </div>
</section>
